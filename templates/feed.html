{% extends "base.html" %}
{% block body %}

<style>
    .memory-row {
        opacity: 0;
        transform: translateY(40px) scale(.97);
        transition: all .5s;
        max-width: 1150px;
        margin: 80px auto;
        color: white;
        font-size: 21px;
        line-height: 1.45;
        white-space: pre-line;
    }

    /* reveal */
    .memory-row.show {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    /* default image float left */
    .memory-row img,
    .memory-row video {
        width: 250px;
        height: 250px;
        object-fit: cover;
        border-radius: 16px;
        box-shadow: 0 0 22px rgba(0, 0, 0, .45);
        float: left;
        margin: 0 25px 10px 0;
        cursor: pointer;
    }

    /* alternate (right side) */
    .memory-row.right-img img,
    .memory-row.right-img video {
        float: right;
        margin: 0 0 10px 25px;
    }

    .memory-row::after {
        content: "";
        display: block;
        clear: both;
    }


    /* mobile */
    @media(max-width:700px) {
        .memory-row {
            font-size: 17px;
        }

        .memory-row img,
        .memory-row video {
            float: none !important;
            display: block;
            margin: 0 auto 15px auto !important;
            width: 170px !important;
            height: 170px !important;
        }
    }
</style>

<div class="container py-5" style="max-width:1250px;margin:auto;">

    {% for p in docs %}

    <div class="memory-row {% if loop.index0%2==1 %}right-img{% endif %}">

        {% if 'mp4' in p.url or 'webm' in p.url or 'mov' in p.url %}
        <video src="{{ p.url|replace('/upload/','/upload/w_350,h_350,c_fill/') }}" data-full="{{ p.url }}" controls
            onclick="zoomMedia(this,true)" loading="lazy"></video>
        {% else %}
        <img src="{{ p.url|replace('/upload/','/upload/w_350,h_350,c_fill/') }}" data-full="{{ p.url }}"
            onclick="zoomMedia(this,false)" loading="lazy">
        {% endif %}

        {{ p.desc }}

    </div>

    {% endfor %}
</div>

<!-- feedback + zoom scripts remain same -->
<script>
    document.addEventListener("scroll", () => { document.querySelectorAll(".memory-row").forEach(r => { if (r.getBoundingClientRect().top < window.innerHeight - 70) r.classList.add("show") }) });
    window.addEventListener("load", () => { document.querySelectorAll(".memory-row").forEach(r => { if (r.getBoundingClientRect().top < window.innerHeight - 70) r.classList.add("show") }) });
    function zoomMedia(el, isVideo) { const full = el.dataset.full; const modal = document.getElementById('zoomModal'); const zi = document.getElementById('zoomImg'); const zv = document.getElementById('zoomVid'); if (isVideo) { zi.style.display = "none"; zv.style.display = "block"; zv.src = full; } else { zv.style.display = "none"; zi.style.display = "block"; zi.src = full; } modal.style.display = "flex"; }
    function closeZoom() { document.getElementById('zoomModal').style.display = "none"; }
</script>

{% endblock %}