{% extends "base.html" %}
{% block body %}

<!-- WELCOME NAME POPUP -->
{% if show_popup %}
<div id="welcome-box">
    Hi {{ firstname }}!<br>
    <small>{{ quote }}</small>
</div>
{% endif %}

<style>
    /* welcome popup */
    #welcome-box {
        position: fixed;
        bottom: 20px;
        left: -350px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 18px 25px;
        border-radius: 12px;
        font-size: 19px;
        z-index: 999999;
        animation: slideIn 0.6s forwards, slideOut 0.6s forwards 2.6s;
    }

    @keyframes slideIn {
        from {
            left: -350px;
            opacity: 0;
        }

        to {
            left: 30px;
            opacity: 1;
        }
    }

    @keyframes slideOut {
        to {
            left: 400px;
            opacity: 0;
        }
    }


    .memory-text {
        width: auto;
        color: white;
        font-size: 20px;
        line-height: 1.4;
    }


    /* FEEDBACK BOX RIGHT BOTTOM */
    #feedback-box {
        position: fixed;
        bottom: 35px;
        right: 35px;
        z-index: 9999;
    }
</style>


<div class="container py-5">

    {% for p in docs %}
    <div class="memory-row" style="{% if loop.index0%2==1 %}flex-direction:row-reverse;{% endif %}">

        {% if 'mp4' in p.url or 'webm' in p.url or 'mov' in p.url %}
        <video src="{{ p.url }}" controls class="memory-pic"></video>
        {% else %}
        <img src="{{ p.url }}" class="memory-pic">
        {% endif %}

        <div class="memory-text" style="{% if loop.index0%2==1 %}text-align:right;{% endif %}">
            <b>{{ p.place }}</b> — {{ p.date }} <br><br>
            {{ p.desc }}
        </div>

    </div>
    {% endfor %}

</div>


<!-- FEEDBACK BOX -->
<div id="feedback-box">
    <form action="/feedback" method="POST">
        <textarea name="msg" placeholder="Feedback..."
            style="width:230px;height:70px;border-radius:8px;padding:8px;"></textarea>
        <button class="btn btn-primary btn-sm mt-2 w-100">Send</button>
    </form>
</div>


<script>
    setTimeout(() => { let w = document.getElementById("welcome_msg"); if (w) w.style.display = "none"; }, 3500);

    const posts = document.querySelectorAll(".memory-row");
    window.addEventListener("scroll", () => {
        posts.forEach(p => {
            const pos = p.getBoundingClientRect().top;
            if (pos < window.innerHeight - 90) { p.classList.add("show"); }
        });
    });
</script>
{% if session.get('just_logged') %}
<div id="welcome-box">
    Hi {{ firstname }}!<br>
    <small>“Every picture is a story we lived.”</small>
</div>
<script>
    sessionStorage.setItem("removeWelcome", "1");
</script>
{% endif %}

{% endblock %}